<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.js" crossorigin="anonymous"></script>
<script src="/js/gauge.min.js" crossorigin="anonymous"></script>
<script>
  if (<%= @logged_in_as.weight %> == 0) {
    $('#getStartedModal').modal('show');
  }
</script>
<div class="col-6 left-pane">
<h1>Dashboard.</h1> 
<button type="button" class="profilebtn btn btn-outline-secondary" data-toggle="modal" data-target="#editModal">Edit Profile</button>
<div class="list-group" id="list-tab" role="tablist" style="padding-right: 90px;">
<button type="button" class="btn btn-outline-secondary" id="list-addfood-list" style="float: right; margin-right: 10px; margin-top: 10px;" data-toggle="list" href="#list-addfood" role="tab" aria-controls="addfood">Add Meal</button>
</div>
<hr>
<div class="row" style="cursor: default;">

  <div class="list-group col-5" id="list-tab" role="tablist" style="margin:0; padding: 0; padding-left: 15px;">

  <ul>
    <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-weight-list" data-toggle="list" href="#list-weight" role="tab" aria-controls="weight"><b>Weight:</b> <%= @logged_in_as.weight %>lbs</li><br />
    <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-height-list" data-toggle="list" href="#list-height" role="tab" aria-controls="height"><b>Height:</b> <%= @logged_in_as.height %>in</li><br />
    <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-age-list" data-toggle="list" href="#list-age" role="tab" aria-controls="age"><b>Age:</b> <%= @logged_in_as.age %></li><br />
    <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-lifestyle-list" data-toggle="list" href="#list-lifestyle" role="tab" aria-controls="lifestyle"><b>Lifestyle:</b> <%= @logged_in_as.lifestyle %></li><br />
      <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-bmi-list" data-toggle="list" href="#list-bmi" role="tab" aria-controls="bmi"><b>BMI:</b> <%= @logged_in_as.bmi %></li> <br />
    <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-mcal-list" data-toggle="list" href="#list-mcal" role="tab" aria-controls="mcal"><b>Max Calories:</b> <%= @logged_in_as.maxcal %></li>
  </ul>
</div>
 <div class="list-group col-5" id="list-tab" role="tablist" style="margin:0; padding: 0;">

  <ul>
      <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-tweight-list" data-toggle="list" href="#list-tweight" role="tab" aria-controls="tweight"><b>Target Weight:</b> <%= @logged_in_as.tweight %>lbs</li><br />
      <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-sex-list" data-toggle="list" href="#list-sex" role="tab" aria-controls="sex"><b>Sex:</b> <%= @logged_in_as.sex %></li><br />
      <li class="list-group-item list-group-item-secondary list-group-item-action disabled" id="list-tcal-list" data-toggle="list" href="#list-tcal" role="tab" aria-controls="tcal"><b>Today's Calories:</b> <%= @logged_in_as.calories %></li><br />
      <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-bmr-list" data-toggle="list" href="#list-bmr" role="tab" aria-controls="bmr"><b>BMR:</b> <%= @logged_in_as.bmr %></li> <br />
      <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-tcarbs-list" data-toggle="list" href="#list-tcarbs" role="tab" aria-controls="tcarbs"><b>Today's Carbs:</b> <%= @logged_in_as.carbs %>g</li><br />
      <li class="selectable list-group-item list-group-item-secondary list-group-item-action" id="list-tfat-list" data-toggle="list" href="#list-tfat" role="tab" aria-controls="tfat"><b>Today's Fat:</b> <%= @logged_in_as.fat %>g</li>
    </ul>
  </div>
    </div>
    <div class="tab-content col-7" id="nav-tabContent" style="padding-left: 15px;">
      <br />
      <div class="tab-pane fade" id="list-lifestyle" role="tabpanel" aria-labelledby="list-lifestyle-list">If you get little or no exercise, choose <i>Sedentary</i>.<br>If you exercise 1-3 days a week, choose <i>Lightly Active</i>.<br>If you exercise 3-5 days a week, choose <i>Moderately Active</i>.<br>If you exercise 6-7 days a week, choose <i>Very Active</i>.<br>If you exercise more than all of the options above, choose <i>Highly Active</i>.</div>
      <div class="tab-pane fade" id="list-age" role="tabpanel" aria-labelledby="list-age-list">Your <i>age</i> is a major factor in  calculating your <i>BMI</i> and <i>BMR</i>.</div>
      <div class="tab-pane fade" id="list-height" role="tabpanel" aria-labelledby="list-height-list"></div>
      <div class="tab-pane fade" id="list-weight" role="tabpanel" aria-labelledby="list-weight-list"></div>
      <div class="tab-pane fade" id="list-bmi" role="tabpanel" aria-labelledby="list-bmi-list">Body mass index, or BMI, is a measure of body size.<br>If your BMI is less than 18.5, it falls within the underweight range.<br>If your BMI is 18.5 to 25, it falls within the normal.<br>If your BMI is 25.0 to 30, it falls within the overweight range.<br>If your BMI is 30.0 or higher, it falls within the obese range.</div>
      <div class="tab-pane fade" id="list-bmr" role="tabpanel" aria-labelledby="list-bmr-list">Basal Metabolic Rate, or BMR, is the number of calories<br>you burn a day while at rest (without exercise).<br>BMR is also known as your body's metabolism. <br>Any increase to your metabolic weight, such as exercise, <br>will increase your BMR.</div>
      <div class="tab-pane fade" id="list-tweight" role="tabpanel" aria-labelledby="list-tweight-list"></div>
      <div class="tab-pane fade" id="list-tcarbs" role="tabpanel" aria-labelledby="list-tcarbs-list">Carbs should provide 45 to 65 percent of your daily calorie intake.<br>Based on a 2000-calorie diet, aim for 225-325g of carbs a day.<br />If you need to lose weight, eat around 50-150g of carbs a day.</div>
      <div class="tab-pane fade" id="list-tfat" role="tabpanel" aria-labelledby="list-tfat-list">Fat should provide 20% to 35% of total calories from fat.<br>That is 44g-77g of fat per day if you eat 2,000 calories a day.<br />If you need to lose weight, eat around 50g of fats a day.</div>
      <div class="tab-pane fade" id="list-mcal" role="tabpanel" aria-labelledby="list-mcal-list">This is the max amount of calories you should eat<br />a day if you want to lose a pound a week.</div>
      <div class="tab-pane fade" id="list-addfood" role="tabpanel" aria-labelledby="list-addfood-list">
        
      <form class="form-vertical" id="searchForm">
      <fieldset>
        <div class="form-group">
          <div class="row">
            <div class="col-md-8" style="padding-right: 0px;">
              <input id="search" name="search" type=search" class="form-control input-md" required="">
            </div>
            <div class="col-md-2" style="padding-left: 5px;">
              <button type="submit" class="btn btn-primary" type="button" aria-label="Search">
                <span aria-hidden="true" class="white-text">Search</span>
              </button>
            </div>
          </div>
        </div>
      </fieldset>
    </form>
    <div class="row" id="searchResults" style="height:26vh; width:45vh; margin-left: 1px;overflow-y: scroll;">
      
    </div>
  </div>
</div>
</div>


  <div class="col-med-6 right-pane">
    <h1>Progress.</h1> 
    <hr style="width:100%">
    <div class="gauge text-center" style="float:left;">
      <canvas width="200" height="100" id="calgauge" ></canvas><br>Calories:
      <div id="calgauge-textfield" style="font-size: 15px;">0</div>
    </div>

    <div class="gauge text-center" style="float:right;">
      <canvas width="200" height="100" id="carbgauge"></canvas><br>Carbs:
      <div id="carbgauge-textfield" style="font-size: 15px;"><%= @logged_in_as.carbs %></div>
    </div><br>    

    <div class="gauge text-center"  style="float:left;">
      <canvas width="200" height="100" id="fatgauge"></canvas><br>Fats:
      <div id="fatgauge-textfield" style="font-size: 15px;">0</div>
    </div>    

    <div class="gauge text-center"  style="float:right;">
      <canvas width="200" height="100" id="bmigauge"></canvas><br>BMI:
      <div id="bmigauge-textfield" style="font-size: 15px;">0</div>
    </div>    
<script>
var calopts = {
  angle: 0,
  lineWidth: .33, 
  radiusScale: .6,
  fontSize: 41,
  divisions: 3,
  divLength: 100,
  pointer: {
    length: .8, 
    strokeWidth: 0.01, 
    color: '#000000' 
  },
  renderTicks: {
    divisions: 3,
    divWidth: 1.1,
    divLength: 1,
    divColor: '#333333',
  },
  limitMax: 'true', 
  colorStart: '#2DA3DC', 
  colorStop: '#C0C0DB', 
  strokeColor: '#EEEEEE'
};
var caltarget = document.getElementById('calgauge'); // your canvas element
var calgauge = new Gauge(caltarget).setOptions(calopts); // create sexy gauge!
calgauge.maxValue = <%= @logged_in_as.maxcal %>; // set max gauge value
calgauge.animationSpeed = 32; // set animation speed (32 is default value)
calgauge.set(<%= @logged_in_as.calories %>); // set actual value
calgauge.setTextField(document.getElementById("calgauge-textfield"));

var carbopts = {
  angle: 0,
  lineWidth: .33, 
  radiusScale: .6,
  fontSize: 41,
  divisions: 3,
  divLength: 100,
  pointer: {
    length: .8, 
    strokeWidth: 0.01, 
    color: '#000000' 
  },
  renderTicks: {
    divisions: 3,
    divWidth: 1.1,
    divLength: 1,
    divColor: '#333333',
  },
  limitMax: 'true', 
  colorStart: '#2DA3DC', 
  colorStop: '#C0C0DB', 
  strokeColor: '#EEEEEE'
};
var carbtarget = document.getElementById('carbgauge'); // your canvas element
var carbgauge = new Gauge(carbtarget).setOptions(carbopts); // create sexy gauge!
carbgauge.maxValue = 300; // set max gauge value
carbgauge.animationSpeed = 32; // set animation speed (32 is default value)
carbgauge.set(<%= @logged_in_as.carbs %>); // set actual value
carbgauge.setTextField(document.getElementById("carbgauge-textfield"));

var fatopts = {
  angle: 0,
  lineWidth: .33, 
  radiusScale: .6,
  fontSize: 41,
  divisions: 3,
  divLength: 100,
  pointer: {
    length: .8, 
    strokeWidth: 0.01, 
    color: '#000000' 
  },
  renderTicks: {
    divisions: 3,
    divWidth: 1.1,
    divLength: 1,
    divColor: '#333333',
  },
  limitMax: 'true', 
  colorStart: '#2DA3DC', 
  colorStop: '#C0C0DB', 
  strokeColor: '#EEEEEE'
};
var fattarget = document.getElementById('fatgauge'); // your canvas element
var fatgauge = new Gauge(fattarget).setOptions(fatopts); // create sexy gauge!
fatgauge.maxValue = 75; // set max gauge value
fatgauge.animationSpeed = 32; // set animation speed (32 is default value)
fatgauge.set(<%= @logged_in_as.fat %>); // set actual value
fatgauge.setTextField(document.getElementById("fatgauge-textfield"));

var bmiopts = {
  angle: 0,
  lineWidth: .33, 
  radiusScale: .6,
  fontSize: 41,
  divisions: 3,
  divLength: 100,
  pointer: {
    length: .8, 
    strokeWidth: 0.01, 
    color: '#000000' 
  },
  renderTicks: {
    divisions: 3,
    divWidth: 1.1,
    divLength: 1,
    divColor: '#333333',
  },
  limitMax: 'true', 
  colorStart: '#2DA3DC', 
  colorStop: '#C0C0DB', 
  strokeColor: '#EEEEEE'
};
var bmitarget = document.getElementById('bmigauge'); // your canvas element
var bmigauge = new Gauge(bmitarget).setOptions(bmiopts); // create sexy gauge!
bmigauge.maxValue = 42; // set max gauge value
bmigauge.animationSpeed = 32; // set animation speed (32 is default value)
bmigauge.set(<%= @logged_in_as.bmi %>); // set actual value
bmigauge.setTextField(document.getElementById("bmigauge-textfield"));
</script>

<canvas id="calorieChart" width="500" height="200"></canvas>
<canvas id="weightChart" width="500" height="200"></canvas>

<script>
var ctx = document.getElementById('calorieChart').getContext('2d');
var calorieChart = new Chart(ctx, {
    type: 'line',
    data: {
        labels: <%= @graph_dates %>,
        datasets: [{
            label: 'Calories',
            data: <%= @calorie_values %>,
            borderColor: "blue",
            fill: false
        }]
    },
    options: {
      layout: {
        padding: {
          left: 30,
          right: 30
        }
      },
      title: {
        display: true,
        text: 'Calorie Intake Over Time'
      }
    }
});

var wtx = document.getElementById('weightChart').getContext('2d');
var weightChart = new Chart(wtx, {
    type: 'line',
    data: {
        labels: <%= @graph_dates %>,
        datasets: [{
            label: 'Weight',
            data: <%= @weight_values %>,
            borderColor: "blue",
            fill: false
        }]
    },
    options: {
      layout: {
        padding: {
          left: 30,
          right: 30
        }
      },
      title: {
        display: true,
        text: 'Weight over time'
      }
    }
});
</script>
</div>



<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
  aria-hidden="true">
  <div class="modal-dialog modal-notify modal-warning" role="document">
    <!--Content-->
    <div class="modal-content">
      <!--Header-->
      <div class="modal-header text-center">
        <h4 class="modal-title white-text w-100 font-weight-bold py-2">Edit Info</h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true" class="white-text">&times;</span>
        </button>
      </div>

      <!--Body-->
      <div class="modal-body">
          <form class="form-horizontal" action="/users/<%= session[:user_id] %>" method="POST">
          <div class="row">
          <div class="col-6">

          <div class="form-group">
            <label class="control-label" for="age">Age</label>
            <input id="age" name="age" type="text" value="<%= @logged_in_as.age %>" class="form-control input-md" required="">
            </div>

          <div class="form-group">
          <label class="control-label" for="sex">Sex</label><br />
          <div class="input-append btn-group">
          <select id="sex" name="sex" class="form-control input-md" required="">
            <option selected disabled="true"><%= @logged_in_as.sex %></option>
            <option>Male</option>
            <option>Female</option>
          </select>
          </div>
          </div>

          <div class="form-group">
            <label class="control-label" for="height">Height (inches)</label>
            <input id="height" name="height" type="text" value="<%= @logged_in_as.height %>" class="form-control input-md" required="">
            </div>
          </div>
        <div class="col-6">
        <div class="form-group">
          <label class="control-label" for="weight">Weight (lbs)</label>
          <input id="weight" name="weight" type="text" value="<%= @logged_in_as.weight %>" class="form-control input-md" required="">
        </div>

        <div class="form-group">
          <label class="control-label" for="tweight">Target Weight (lbs)</label>
          <input id="tweight" name="tweight" type="text" value="<%= @logged_in_as.tweight %>" class="form-control input-md" required="">
          </div>

        <div class="form-group">
          <label class="control-label" for="lifestyle">Lifestyle</label><br />
 
          <div class="input-append btn-group">
          <select id="lifestyle" name="lifestyle" class="form-control input-md" required="">
            <option selected disabled="true"><%= @logged_in_as.lifestyle %></option>
            <option>Sedentary</option>
            <option>Lightly Active</option>
            <option>Moderately Active</option>
            <option>Very Active</option>
            <option>Highly Active</option>
          </select>
          </div>
        </div>
      </div>
      </div>
    </div>
      <!--Footer-->
      <div class="modal-footer justify-content-center">
        <div class="form-group">
          <label class="col-md-4 control-label" for="edit"></label>
          <div class="col-md-4">
            <button type="submit" id="edit" name="edit" class="btn btn-outline-secondary">Submit</button>
          </div>
        </div>
        </form>
      </fieldset>
      </div>
    </div>
  </div>
</div>

<!-- Product Modal -->
<div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content" id="product-modal-header">
      <div class="modal-header">
        <h5 class="modal-title" id="productModalLabel">Product Info</h5>
      </div>
      <form class="form-horizontal" id="addForm">

        <div class="modal-body" >
          <div class="row" id="product-modal-body">
        
          </div>
        </div>
      </form>

        <div class="modal-footer" id="product-modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="submit" id="addProduct" name="addProduct" class="btn btn-primary">Add</button>
        </div>
    </div>
  </div>
</div>
<!-- Get Started Modal -->
<div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="getStartedModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content" id="product-modal-header">
      <div class="modal-header">
        <h5 class="modal-title" id="productModalLabel">Get Started</h5>
      </div>
      <form class="form-horizontal" id="addForm">

        <div class="modal-body" >
          <div class="row" id="product-modal-body">
        
          </div>
        </div>
      </form>

        <div class="modal-footer" id="product-modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#getStartedModal">Continue</button>
        </div>
    </div>
  </div>
</div>